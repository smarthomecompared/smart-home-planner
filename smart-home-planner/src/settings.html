<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="apple-touch-icon" sizes="180x180" href="img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="48x48" href="img/favicon-48x48.png">
    <link rel="icon" type="image/png" sizes="16x16" href="img/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="192x192" href="img/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="img/android-chrome-512x512.png">
    <link rel="manifest" href="img/site.webmanifest">
    <link rel="shortcut icon" href="img/favicon.ico">
    <meta name="theme-color" content="#0f172a">
    <title>Settings - Smart Home Planner</title>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/settings.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-brand">
                <a href="index.html" class="header-home-link">
                    <img src="img/logo.png" alt="Smart Home Planner logo" class="header-logo">
                    <h1 class="header-title">Smart Home Planner</h1>
                </a>
                <button class="nav-toggle" type="button" aria-label="Toggle navigation" aria-expanded="false" aria-controls="main-nav">
                    <svg viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M3 6h18"></path>
                        <path d="M3 12h18"></path>
                        <path d="M3 18h18"></path>
                    </svg>
                </button>
            </div>
            <nav class="site-nav" id="main-nav">
                <a href="index.html">Dashboard</a>
                <a href="devices.html">Devices</a>
                <a href="settings.html" class="active">Settings</a>
            </nav>
        </header>

        <section>
            <div class="section-header">
                <h2>Settings</h2>
            </div>

            <div class="settings-container">
                <div class="settings-section">
                    <h3 class="settings-section-title">Open Source</h3>
                    <p class="settings-description">Explore the project code on GitHub.</p>
                    <a class="github-link" id="github-repo-link" href="https://github.com/smarthomecompared/smart-home-planner" target="_blank" rel="noopener">
                        <svg viewBox="0 0 24 24" aria-hidden="true" class="github-icon">
                            <path d="M12 2c-5.52 0-10 4.48-10 10 0 4.42 2.87 8.17 6.84 9.49.5.1.68-.22.68-.48 0-.24-.01-1.04-.01-1.89-2.78.6-3.37-1.18-3.37-1.18-.46-1.17-1.12-1.48-1.12-1.48-.91-.62.07-.61.07-.61 1.01.07 1.54 1.03 1.54 1.03.9 1.54 2.36 1.1 2.94.84.09-.65.35-1.1.63-1.35-2.22-.25-4.56-1.11-4.56-4.94 0-1.09.39-1.98 1.03-2.68-.1-.25-.45-1.27.1-2.65 0 0 .84-.27 2.75 1.02A9.56 9.56 0 0 1 12 6.8c.85 0 1.71.12 2.51.35 1.9-1.29 2.74-1.02 2.74-1.02.55 1.38.2 2.4.1 2.65.64.7 1.03 1.59 1.03 2.68 0 3.84-2.34 4.69-4.58 4.94.36.31.68.92.68 1.86 0 1.34-.01 2.41-.01 2.74 0 .26.18.59.69.48A10.01 10.01 0 0 0 22 12c0-5.52-4.48-10-10-10z"></path>
                        </svg>
                        <span id="github-repo-text">github.com/smarthomecompared/smart-home-planner</span>
                    </a>
                </div>

                <div class="settings-section">
                    <h3 class="settings-section-title">Data Management</h3>
                    <p class="settings-description">Export your data to a JSON file for backup, or import data from a previously exported file.</p>
                    
                    <div class="settings-actions">
                        <div class="settings-action-group">
                            <h4>Export Data</h4>
                            <p>Download your devices, networks, and settings as a JSON file.</p>
                            <button class="btn btn-primary" id="export-btn">Export Data</button>
                        </div>

                        <div class="settings-action-group">
                            <h4>Import Data</h4>
                            <p>Import data from a JSON file. This will replace all existing data.</p>
                            <div class="import-wrapper">
                                <input type="file" id="import-file" accept=".json" style="display: none;">
                                <button class="btn btn-secondary" id="import-btn">Choose File</button>
                                <span id="import-file-name" class="import-file-name"></span>
                            </div>
                            <button class="btn btn-danger" id="import-confirm-btn" style="display: none; margin-top: 0.5rem;">Import Data</button>
                        </div>
                    </div>
                </div>

                <div class="settings-section">
                    <h3 class="settings-section-title">Home Assistant Integration</h3>
                    <p class="settings-description">Choose which device area field should be updated from Home Assistant when an existing device is synchronized.</p>
                    <div class="settings-actions">
                        <div class="settings-action-group">
                            <h4>Area Mapping Target</h4>
                            <p>New devices always set both Installed and Controlled Area. Existing devices update only the selected field.</p>
                            <div class="form-group">
                                <label for="ha-area-sync-target">Update this field on sync</label>
                                <select id="ha-area-sync-target">
                                    <option value="installed">Installed Area</option>
                                    <option value="controlled">Controlled Area</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="settings-section">
                    <h3 class="settings-section-title">Networks</h3>
                    <p class="settings-description">Create VLANs to organize devices by network.</p>

                    <div class="networks-grid">
                        <div class="form-group networks-actions">
                            <button class="btn btn-primary" id="network-add-btn">Add Network</button>
                        </div>
                    </div>

                    <div class="networks-list" id="networks-list"></div>
                </div>

                <div class="settings-section">
                    <h3 class="settings-section-title">Device Options</h3>
                    <p class="settings-description">Manage the available options for brands, types, connectivity, and battery types used in device forms.</p>
                    
                    <div id="options-management">
                        <!-- Options will be rendered here -->
                    </div>
                </div>

            </div>
        </section>
    </div>

    <div class="modal is-hidden" id="network-modal" aria-hidden="true">
        <div class="modal-overlay" id="network-modal-overlay"></div>
        <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="network-modal-title">
            <div class="modal-header">
                <div class="modal-title" id="network-modal-title">Add Network</div>
            </div>
            <div class="form-group">
                <label for="network-modal-input">Network Name</label>
                <input type="text" id="network-modal-input" placeholder="e.g., vlan10">
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" type="button" id="network-modal-cancel">Cancel</button>
                <button class="btn btn-primary" type="button" id="network-modal-save">Save</button>
            </div>
        </div>
    </div>

    <script src="js/metadata.js"></script>
    <script src="js/common.js"></script>
    <script src="js/settings.js"></script>
</body>
</html>
